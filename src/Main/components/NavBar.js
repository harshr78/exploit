import * as React from 'react';
import PropTypes from 'prop-types';
import AppBar from '@mui/material/AppBar';
import Toolbar from '@mui/material/Toolbar';
import Typography from '@mui/material/Typography';
import CssBaseline from '@mui/material/CssBaseline';
import useScrollTrigger from '@mui/material/useScrollTrigger';
import Box from '@mui/material/Box';
import Container from '@mui/material/Container';
import ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';
import Popover from '@mui/material/Popover';
import { styled, alpha } from '@mui/material/styles';
import SearchIcon from '@mui/icons-material/Search';
import InputBase from '@mui/material/InputBase';
import HeaderCard from '../widgets/HeaderCard';
import { Link } from 'react-router-dom';
import ExpandMoreIcon from '@mui/icons-material/ExpandMore';
import IconButton from '@mui/material/IconButton';

import navbarApi from '../../Core/api/services/navigation';

const Search = styled('div')(({ theme }) => ({
    position: 'relative',
    borderRadius: theme.shape.borderRadius,
    backgroundColor: alpha(theme.palette.common.white, 0.15),
    '&:hover': {
        backgroundColor: alpha(theme.palette.common.white, 0.25),
    },
    marginRight: theme.spacing(2),
    marginLeft: 0,
    width: '100%',
    [theme.breakpoints.up('sm')]: {
        marginLeft: theme.spacing(3),
        width: 'auto',
    },
}));

const SearchIconWrapper = styled('div')(({ theme }) => ({
    padding: theme.spacing(0, 2),
    height: '100%',
    position: 'absolute',
    pointerEvents: 'none',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
}));

const StyledInputBase = styled(InputBase)(({ theme }) => ({
    color: 'inherit',
    '& .MuiInputBase-input': {
        padding: theme.spacing(1, 1, 1, 0),
        // vertical padding + font size from searchIcon
        paddingLeft: `calc(1em + ${theme.spacing(4)})`,
        transition: theme.transitions.create('width'),
        width: '100%',
        [theme.breakpoints.up('md')]: {
            width: '20ch',
        },
    },
}));


const ExpandMore = styled((props) => {
    const { expand, ...other } = props;
    return <IconButton {...other} />;
})(({ theme, expand }) => ({
    transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',
    marginLeft: 'auto',
    transition: theme.transitions.create('transform', {
        duration: theme.transitions.duration.shortest,
    }),
}));

const ElevateAppBar = (props) => {
    const [anchorEl, setAnchorEl] = React.useState(null);
    const [scroll, setScroll] = React.useState(false);
    const [expanded, setExpanded] = React.useState(false);
    const [navbarData, setNavbarData] = React.useState([]);

    React.useEffect(() => {
        navbarApi(setNavbarData);
        
        window.addEventListener("scroll", () => {
            setScroll(window.scrollY > 50);
        });
    }, []);
    console.log(typeof navbarData)
    const handleExpandClick = () => {
        setExpanded(!expanded);
    };

    const handlePopoverOpen = (event) => {
        setAnchorEl(event.currentTarget);
        handleExpandClick();
    };

    const handleClose = () => {
        setAnchorEl(null);
        handleExpandClick();
    };
    const open = Boolean(anchorEl);
    const id = open ? 'techvanto-course-popover' : undefined;



    







    return (
        <React.Fragment>
            <CssBaseline />
            <AppBar className={scroll ? "bg-royal-blue" : "bg-royal-transparent"}>
                <Container maxWidth="lg">
                    <Toolbar>
                        <Typography variant="h4" component="div" className="tecvanto-navbar-header techvanto-nabar-link technovanto-scroll-hide">
                            Techvanto
                        </Typography>

                        
                        { 
                        navbarData.map((data,index)=>{
                            return(
                                <Container maxWidth="md" sx={{ a: 2 }} >
                            <div >
                                <Typography variant="a" component="div"
                                    onMouseEnter={handlePopoverOpen}
                                    aria-describedby={id}
                                >
                                    <a className="techvanto-nabar-link">
                                        {data.title}
                                        <ExpandMore
                                            expand={expanded}
                                            aria-expanded={expanded}
                                            aria-label="show more"
                                        >
                                            <ExpandMoreIcon sx={{ color: "white" }} />
                                        </ExpandMore>
                                    </a>
                                </Typography>
                                <Popover
                                    id={id}
                                    open={open}
                                    anchorEl={anchorEl}
                                    
                                    anchorOrigin={{
                                        vertical: 'bottom',
                                        horizontal: 'center',
                                    }}
                                    transformOrigin={{
                                        vertical: 'top',
                                        horizontal: 'center',
                                    }}
                                    className="technovanto-scroll-hide"

                                >
                                    <Typography onMouseLeave={handleClose} component="div" sx={{ a: 2 }} className="technovanto-scroll-hide">

                                        <div className="technovanto-navbar-dropdown-content technovanto-scroll-hide">
                                            <div className="technovanto-navbar-dropdown-content-left technovanto-scroll-hide">
                                                <ul className="techvanto-list technovanto-scroll-hide">
                                                    <li className="techvanto-list-header technovanto-scroll-hide">
                                                        Course Category:
                                                    </li>
                                                    <li className="active">
                                                        Microsoft Excel
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                    <li className="">
                                                        Microsoft Office
                                                    </li>
                                                </ul>
                                            </div>

                                            <div className="technovanto-navbar-dropdown-content-right technovanto-scroll-hide">
                                                <div className="technovanto-dropdown-right-card technovanto-scroll-hide">
                                                    <HeaderCard></HeaderCard>
                                                </div>

                                                <div className="technovanto-dropdown-right-link technovanto-scroll-hide">
                                                    <ul className="techvanto-list technovanto-scroll-hide">
                                                        <li className="techvanto-list-header technovanto-scroll-hide">
                                                            Select Category:
                                                        </li>
                                                        <li className="active">
                                                            <Link to="/course">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                        <li className="">
                                                            <Link to="/courses">Microsoft Excel - Basic & Advanced</Link>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>

                                    </Typography>
                                </Popover>

                            </div>  </Container>)
                            })}
                      
                        <Search>
                            <SearchIconWrapper>
                                <SearchIcon />
                            </SearchIconWrapper>
                            <StyledInputBase
                                placeholder="Search…"
                                inputProps={{ 'aria-label': 'search' }}
                            />
                        </Search>
                    </Toolbar>
                </Container>
            </AppBar>

        </React.Fragment>

    );
}

export default ElevateAppBar;