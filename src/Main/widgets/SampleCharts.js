import * as React from 'react';
import "./Assets/charts.css";

const SampleCharts = () => {

    React.useEffect(() => {
        const initialAngle = function (diagram) {
            let initial = 0;
            for (let j = 0; j < diagram.classList.length; j++) {
                initial += parseFloat((/diagram-angle\s*:\s*(.+?)deg/i.exec(diagram.classList[j]) || [])[1]) || 0;
            }
            console.log("initialAngle")
            return initial;
        };

        const diagramStars = function () {
            const diagrams = document.querySelectorAll(".diagram-star");
            console.log("diagramStars")
            for (let i = 0; i < diagrams.length; i++) {
                const diagram = diagrams[i];
                const canvas = document.createElement("canvas"),
                    sections = diagram.querySelectorAll("section").length,
                    width = diagram.offsetWidth * (window.devicePixelRatio || 1),
                    height = diagram.offsetHeight * (window.devicePixelRatio || 1),
                    initial = -90 + initialAngle(diagram);

                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext("2d");

                ctx.strokeStyle = "#9b9b9b";
                ctx.lineWidth = window.devicePixelRatio || 1;
                ctx.beginPath();
                for (let angle = 0; angle < 360; angle += 360 / sections) {
                    // Draw a line from the mid point, to a point at a certain angle
                    ctx.moveTo(width / 2, height / 2);
                    ctx.lineTo(
                        width / 2 + width / 2 * Math.cos((angle + initial) * Math.PI / 180),
                        height / 2 + height / 2 * Math.sin((angle + initial) * Math.PI / 180));
                }
                ctx.stroke();

                diagram.style.backgroundImage = `url(${canvas.toDataURL("image/png")})`;
            }
        };

        const diagramPositions = function () {
            console.log("diagramPositions");
            const alignment = function (angle) {
                if (angle < 0) { angle %= 360; }
                if (angle >= 360) { angle = angle % 360 + 360; }

                if (angle >= 330 || angle < 30) {
                    return "top";
                }
                if (angle >= 150 && angle < 210) {
                    return "bottom";
                }
                if (angle >= 30 && angle < 150) {
                    return "right";
                }
                return "left";
            }

            const rem = parseInt(window.getComputedStyle(document.querySelector("html"), null).getPropertyValue("font-size"), 10);
            const diagrams = document.querySelectorAll(".diagram");

            for (let i = 0; i < diagrams.length; i++) {
                const diagram = diagrams[i],
                    sections = diagram.querySelectorAll("section"),
                    width = diagram.offsetWidth / rem,
                    height = diagram.offsetHeight / rem,
                    initial = -90 + initialAngle(diagram);

                for (let j = 0; j < sections.length; j++) {
                    const section = sections[j],
                        angle = 360 / sections.length * j + initial,
                        x = width / 2 * Math.cos(angle * Math.PI / 180),
                        y = height / 2 * Math.sin(angle * Math.PI / 180);

                    section.style.left = `calc(50% + ${x}rem)`;
                    section.style.top = `calc(50% + ${y}rem)`;
                    section.classList.remove("alignment-top", "alignment-right", "alignment-bottom", "alignment-left");
                    section.classList.add(`alignment-${alignment(angle + 90)}`);
                }
            }
        };

        // Replace this with ResizeObserver when the time is ready
        const watch = function (what, trigger) {
            let value = what();
            trigger();

            const check = function () {
                let current = what();
                if (current !== value) {
                    trigger();
                    value = current;
                }
                setTimeout(check, 100);
            };

            setTimeout(check, 100);
        };

        const diagrams = document.querySelectorAll(".diagram"),
            starDiagrams = document.querySelectorAll(".diagram-star");
        console.log(diagrams,starDiagrams,"digrams")
        watch(
            function () {
                let result = 0;
                for (let i = 0; i < diagrams.length; i++) {
                    result = result ^ diagrams[i].offsetWidth;
                }
                return result;
            },
            diagramPositions
        );
        watch(
            function () {
                let result = 0;
                for (let i = 0; i < starDiagrams.length; i++) {
                    result = result ^ starDiagrams[i].offsetWidth;
                }
                return result;
            },
            diagramStars
        );
    }, [])


    return (
        <div>
            <div className="wrapper">
                <div className="diagram diagram-circle">
                    <section>
                        <span className="diagram-icon fa fa-search" />
                        <span className="diagram-label">Search &amp;<br />Navigation</span>
                        <div className="diagram-popup">
                            <h3>Search &amp; Navigation</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-edit" />
                        <span className="diagram-label">Blog &amp;
                            CMS Functionality</span>
                        <div className="diagram-popup">
                            <h3>Blog &amp; CMS Functionality</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-shopping-cart" />
                        <span className="diagram-label">Full B2B
                            Procurement</span>
                        <div className="diagram-popup">
                            <h3>Full B2B Procurement</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-line-chart" />
                        <span className="diagram-label">Cross-sell &amp;
                            Upsell</span>
                        <div className="diagram-popup">
                            <h3>Cross-sell &amp; Upsell</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-mobile" />
                        <span className="diagram-label">Coupons, Gift Cards,
                            Premiums,
                            Promotions &amp;
                            Discounts</span>
                        <div className="diagram-popup">
                            <h3>Coupons, Gift Cards, Premiums, Promotions &amp; Discounts</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-bar-chart" />
                        <span className="diagram-label">SEO
                            optimization</span>
                        <div className="diagram-popup">
                            <h3>SEO optimization</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                </div>
            </div>
            <div className="wrapper">
                <div className="diagram diagram-star diagram-angle:-36deg">
                    <header>
                        <span className="diagram-icon fa fa-search" />
                        <span className="diagram-label">CloudSuite
                            Commerce</span>
                    </header>
                    <section>
                        <span className="diagram-icon fa fa-search" />
                        <span className="diagram-label">API</span>
                        <div className="diagram-popup">
                            <h3>API</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-cog" />
                        <span className="diagram-label">CMS</span>
                        <div className="diagram-popup">
                            <h3>CMS</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-edit" />
                        <span className="diagram-label">PIM</span>
                        <div className="diagram-popup">
                            <h3>PIM</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                    <section>
                        <span className="diagram-icon fa fa-shopping-cart" />
                        <span className="diagram-label">DAM</span>
                        <div className="diagram-popup">
                            <h3>DAM</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus feugiat nec mi et ultricies. Praesent consectetur blandit nulla eget vehicula. Curabitur porttitor a sapien vel mollis. Donec aliquet, arcu vitae feugiat convallis, justo dolor pretium augue, eget mattis nunc leo non tortor. Praesent ornare nibh id ipsum feugiat elementum. Ut vestibulum arcu a nisl posuere, nec molestie nisi dignissim. Ut condimentum dapibus ligula.</p>
                        </div>
                    </section>
                </div>
            </div>
        </div>

    )
}


export default SampleCharts;