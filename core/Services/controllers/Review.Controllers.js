const db = require("../../Connection/index.models")

let review = db.Review;
let sequelize = db.sequelize;
// Retrieve all data from the database.
exports.getAverageAndCount = async (condition = null) => {
  return new Promise((resolve, reject) => {
    review.findAll({ where: condition,
        attributes: [[sequelize.fn('avg', sequelize.col('rating')), 'averageRating'],[sequelize.fn('count', sequelize.col('rating')), 'totalRating']],  
    })
      .then(data => {
        resolve(data)
      })
      .catch(err => {
        reject("something went wrong");
      })
  })
};